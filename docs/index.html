<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Compare gridded population estimates â€¢ popcompr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Compare gridded population estimates">
<meta property="og:description" content="This package makes comparing different gridded population datasets at the pixel level and at the admin level easier. These datasets are commonly used in research and humanitarian contexts, and this package allows users compare datasets, conduct sensitivity analyses, etc. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">popcompr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/popcompr.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/mrajeev08/popcompr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="popcompr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#popcompr" class="anchor"></a>popcompr</h1></div>
<p><code>popcompr</code> is an R package to make it easier different high resolution population datasets for humanitarian and research purposes. It is under active development and has not been released, but the code is available through a <a href="LICENSE.html">GPL3 license</a>. See the documentation at <a href="https://mrajeev08.github.io/popcompr/">https://mrajeev08.github.io/popcompr/</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of <code>popcompr</code> using the <code>remotes</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"mrajeev08/popcompr"</span><span class="op">)</span></pre></div>
</div>
<div id="example-using-data-from-lesotho" class="section level2">
<h2 class="hasAnchor">
<a href="#example-using-data-from-lesotho" class="anchor"></a>Example using data from Lesotho</h2>
<p>Included in the package are two datasets on population estimates in Lesotho (simply choosing Lesotho because its small) downloaded from <a href="https://data.humdata.org">HDX</a>. See <code>?lso_worlpop_2019</code> and <code><a href="reference/lso_facebook_2019.html">?lso_facebook_2019</a></code> for more details. You have to access them using the system.file arguments so that the functions can correctly work with the raster files stored on the disk.</p>
<p>This example compares these two datasets at a default resolution of 0.0833 degrees (or approximately 1 km<sup>2</sup> at the equator):</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mrajeev08.github.io/popcompr">popcompr</a></span><span class="op">)</span>

<span class="co"># comparing at pixel level with data included in the package</span>
<span class="va">lesotho_fb_2019</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/lso_worlpop_2019.tif"</span>, package<span class="op">=</span><span class="st">"popcompr"</span><span class="op">)</span><span class="op">)</span>
<span class="va">lesotho_wp_2019</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"external/lso_facebook_2019.tif"</span>, package<span class="op">=</span><span class="st">"popcompr"</span><span class="op">)</span><span class="op">)</span>
<span class="va">pop_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">lesotho_wp_2019</span>, <span class="va">lesotho_fb_2019</span><span class="op">)</span>

<span class="co"># compare pop function</span>
<span class="fu"><a href="reference/compare_pop.html">compare_pop</a></span><span class="op">(</span><span class="va">pop_list</span>, parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<p>You can also compare population estimates at the administrative level. Access to country shapefiles is provided through a wrapper to the <a href="https://www.geoboundaries.org/api.html">geoBoundaries API</a>. To see available datasets, use <code>View(iso_codes</code>)`. An example for Lesotho:</p>
<ul>
<li>Get admin shapefile</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="co"># Find the right iso code &amp; see which admin levels are available</span>
<span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">iso_codes</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span><span class="op">(</span><span class="st">"Les"</span>, <span class="va">country</span><span class="op">)</span><span class="op">)</span>
<span class="va">les_shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/get_country_shape.html">get_country_shape</a></span><span class="op">(</span>country_iso <span class="op">=</span> <span class="st">"LSO"</span>, admin_level <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></pre></div>
<ul>
<li>And then aggregate the population datasets to the admin unit:</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="co"># get admin level comparison</span>
<span class="va">les_shape</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/aggregate_to_shp.html">aggregate_to_shp</a></span><span class="op">(</span>brick <span class="op">=</span> <span class="va">exe</span>, sf <span class="op">=</span> <span class="va">les_shape</span>, max_adjacent <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></pre></div>
<p>See the <a href="https://mrajeev08.github.io/popcompr/">documentation</a> for examples of vizualizations.</p>
<p>Here are also some great resources on gridded population datasets from CIESIN at Columbia University: <a href="https://sedac.ciesin.columbia.edu/mapping/popgrid">https://sedac.ciesin.columbia.edu/mapping/popgrid</a>.</p>
</div>
</div>
<div id="dev-in-docker" class="section level1">
<h1 class="hasAnchor">
<a href="#dev-in-docker" class="anchor"></a>Dev in docker</h1>
<p>First clone the repo:</p>
<pre><code>git clone </code></pre>
<p>Then with docker installed, build the image (might take a while if rocker/geospatial is not already built):</p>
<pre><code></code></pre>
<p>Then run your container:</p>
<pre><code>docker run -d -p 8787:8787 --name popcompr -e USER=mrajeev -e PASSWORD=pass popcompr:latest</code></pre>
<p>Navigate to <code>http://localhost:8787</code> in your browser and then use the username and password to use Rstudio.</p>
<div id="roadmap" class="section level2">
<h2 class="hasAnchor">
<a href="#roadmap" class="anchor"></a>Roadmap</h2>
<p>This package is in itâ€™s very starting stages. Hereâ€™s the planned/proposed dev.</p>
<div id="little-fixes" class="section level3">
<h3 class="hasAnchor">
<a href="#little-fixes" class="anchor"></a>Little fixes</h3>
<ul>
<li>managing imports from <code>data.table</code> &amp; <code>raster</code> (including conflict with <code>shift</code>)</li>
<li>supress or manage warnings on <code>data.table</code> with <code>gmin</code> in <code>match_nearest</code>
</li>
<li>generally refactor <code>match_nearest</code> to be faster and cleaner</li>
<li>double check where people go missing (is it because of holes? technically extents should be merged and should cover all the raster inputs)</li>
<li>better guidance on resolution and rationale for default</li>
<li>rename <code>iso_codes</code> to geoBoundaries_data</li>
<li>option to pass a field to aggregate to (i.e.Â if you download adm3 shapefile, make it easier to aggregate to admin 2/1?)</li>
</ul>
</div>
<div id="refactoring-existing-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#refactoring-existing-functions" class="anchor"></a>Refactoring existing functions</h3>
<ul>
<li>use a unified naming system so that you can programitcally decide what to plot and also parse labels (i.e.Â data contract)</li>
<li>right now, defaults to a memory safe aggregation method using chunks regardless of raster size.
<ul>
<li>benchmark to see when single calls are faster</li>
<li>programatically decide when to do it the memory safe way (using <code><a href="https://rdrr.io/pkg/raster/man/programming.html">raster::canProcessInMemory</a></code>)</li>
</ul>
</li>
<li>warn/error if extents donâ€™t match by at least xx% between population rasters or shapefiles</li>
<li>donâ€™t make the user parallelize, but instead use future?</li>
<li>multithreaded downloads?</li>
<li>write unit tests!</li>
</ul>
</div>
<div id="expanding-code-base" class="section level3">
<h3 class="hasAnchor">
<a href="#expanding-code-base" class="anchor"></a>Expanding code base</h3>
<ul>
<li>autoplot functions (use S3 classes)? For static/interactive plots comparing up to N pop</li>
<li>API access to available population datasets by country:
<ul>
<li>World Pop (has an API)</li>
<li>Facebook/CIESIN (no API but on hdx)</li>
<li>grid3 (no API but on hdx)</li>
<li>GPW4 (no API and requires registration for download)</li>
<li>LANDSCAN (no API and requires registration for download)</li>
<li>see <a href="https://www.popgrid.org/data-docs-table1">https://www.popgrid.org/data-docs-table1</a> for more details on all datasets</li>
<li>
<a href="https://github.com/dickoa/rhdx" class="uri">https://github.com/dickoa/rhdx</a> for example of accessing files through hdx api</li>
</ul>
</li>
<li>option to crop files to an extent and then do the comparison?</li>
</ul>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/mrajeev08/popcompr/">https://â€‹github.com/â€‹mrajeev08/â€‹popcompr/â€‹</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Malavika Rajeev <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-6030-4995" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Malavika Rajeev.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
